// backend/prisma/schema.prisma
// Schéma Prisma complet pour Sport Tracker Pro V2

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ============================================
// MODÈLE USER
// ============================================
model User {
  id       String   @id @default(cuid())
  email    String   @unique
  password String
  name     String
  weight   Float    @default(70)
  role     String   @default("user")
  
  // Relations
  cardioActivities CardioActivity[]
  muscuActivities  MuscuActivity[]
  weightEntries    WeightEntry[]
  exercises        Exercise[]
  
  @@map("User")
}

// ============================================
// MODÈLE EXERCISE
// ============================================
model Exercise {
  id     String  @id @default(cuid())
  name   String
  type   String  // 'cardio' ou 'muscu'
  userId String?
  
  // Relations
  user             User?            @relation(fields: [userId], references: [id], onDelete: Cascade)
  cardioActivities CardioActivity[]
  muscuActivities  MuscuActivity[]
  
  @@map("Exercise")
}

// ============================================
// MODÈLE CARDIO ACTIVITY
// ============================================
model CardioActivity {
  id         String  @id @default(cuid())
  userId     String
  exerciseId String
  date       String
  minutes    Int
  intensity  String
  calories   Float
  
  // Relations
  user     User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  exercise Exercise @relation(fields: [exerciseId], references: [id])
  
  @@map("CardioActivity")
}

// ============================================
// MODÈLE MUSCU ACTIVITY
// ============================================
model MuscuActivity {
  id         String  @id @default(cuid())
  userId     String
  exerciseId String
  date       String
  sets       Int
  reps       Int
  weight     Float
  calories   Float
  
  // Relations
  user     User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  exercise Exercise @relation(fields: [exerciseId], references: [id])
  
  @@map("MuscuActivity")
}

// ============================================
// MODÈLE WEIGHT ENTRY
// ============================================
model WeightEntry {
  id         String  @id @default(cuid())
  userId     String
  date       String
  weight     Float
  bodyFat    Float?
  muscleMass Float?
  
  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@map("WeightEntry")
}
